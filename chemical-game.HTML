<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Chemistry Laws Simulation</title>
<style>
  body {
    margin: 0; 
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #111;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* MAIN MENU */
  #mainMenu {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 40px;
    width: 100%;
    max-width: 480px;
    min-height: 90vh;
    position: relative;
    overflow: hidden;
  }
  #mainMenu h1 {
    font-size: 3rem;
    margin-bottom: 30px;
    letter-spacing: 3px;
  }
  .menu-button {
    background: #ff5a5f;
    border: none;
    border-radius: 30px;
    color: white;
    font-size: 1.6rem;
    font-weight: 600;
    padding: 14px 48px;
    margin: 12px 0;
    cursor: pointer;
    box-shadow: 0 3px 7px rgba(255, 90, 95, 0.6);
    transition: background-color 0.3s;
    width: 100%;
    max-width: 300px;
  }
  .menu-button:hover {
    background-color: #ff7a7f;
  }
  .menu-subtitle {
    margin-top: 10px;
    color: #bbb;
    font-size: 1rem;
  }

  /* Falling atoms background on main menu */
  .fallingAtom {
    position: fixed;
    font-size: 16px;
    color: rgba(255,255,255,0.1);
    user-select: none;
    pointer-events: none;
    animation-timing-function: linear;
    animation-name: fall;
  }
  @keyframes fall {
    0% { transform: translateY(-10vh); }
    100% { transform: translateY(110vh); }
  }

  /* Game modes container styles */
  .gameMode {
    display: none;
    flex-direction: column;
    align-items: center;
    padding: 24px;
    width: 100%;
    max-width: 480px;
    min-height: 90vh;
  }
  .gameMode.active {
    display: flex;
  }

  /* Return button */
  .return-btn {
    background: #444;
    border: none;
    border-radius: 25px;
    color: white;
    padding: 10px 28px;
    margin-top: 12px;
    font-size: 1.1rem;
    cursor: pointer;
    box-shadow: 0 3px 5px rgba(0,0,0,0.5);
    align-self: center;
    transition: background-color 0.3s;
  }
  .return-btn:hover {
    background-color: #666;
  }

  /* Slider container */
  .slider-container {
    margin: 12px 0;
    width: 100%;
  }
  label {
    font-size: 1.1rem;
    display: block;
    margin-bottom: 4px;
  }
  input[type="range"] {
    width: 100%;
  }

  /* -------- BOYLE MODE -------- */
  #boyle {
    background: radial-gradient(circle at center, #2a1a6a, #111);
    align-items: center;
  }
  #boyle .container {
    width: 400px;
    height: 500px;
    margin-bottom: 40px;
  }
  #boyleCanvas {
    background:#222;
    border-radius:12px;
    display: block;
    margin: 0 auto;
  }

  /* -------- CHARLES MODE -------- */
  #charles {
    background: radial-gradient(circle at center, #4a2a1a, #111);
    align-items: center;
  }
  #charlesBalloon {
    width: 120px;
    height: 180px;
    border-radius: 60px / 90px;
    background-color: rgba(255, 90, 95, 0.99) !important; /* almost fully opaque */
    box-shadow: 0 0 15px rgba(255, 90, 95, 0.4);
    position: relative;
    margin-top: 30px;
    transition: background-color 0.3s;
  }
  #charlesContainer {
    width: 250px;
    height: 350px;
    background: #222;
    border-radius: 16px;
    box-shadow: inset 0 0 20px #c44242;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
  }
  #charlesTempSlider {
    margin-top: 30px;
  }

  /* -------- AVOGADRO MODE -------- */
  #avogadro {
    background: radial-gradient(circle at center, #3a1a4a, #111);
    flex-direction: column;
    align-items: center;
  }
  #avogadro .container {
    width: 350px;
    height: 300px;
    margin-bottom: 20px;
    overflow: hidden;
    position: relative;
  }
  #avogadro h2 {
    margin-bottom: 12px;
  }
  .balloon-container {
    position: relative;
    width: 100%;
    height: 250px;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #avogadroBalloon {
    width: 50px;
    height: 50px;
    max-width: 100px;
    max-height: 100px;
    background-color: rgba(255, 90, 95, 0.25);
    border-radius: 50%;
    box-shadow: 0 0 15px rgba(255,90,95,0.5);
    transition: width 0.2s ease, height 0.2s ease;
    position: relative;
  }
  .molecule-teller-bg {
    font-size: 180px;
    font-weight: 900;
    opacity: 0.1;
    letter-spacing: 20px;
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    user-select: none;
  }
  .molecule-counter {
    font-size: 48px;
    font-weight: 600;
    top: 60px;
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    user-select: none;
    color: #ff5a5f;
    text-shadow: 0 0 5px #ff5a5f;
  }
  #avogadroIncreaseBtn {
    order: 2;
    width: auto;
    font-size: 1.3rem;
    background:#ff5a5f;
    border:none;
    border-radius:30px;
    color:white;
    padding:12px 30px;
    cursor:pointer;
    box-shadow:0 3px 7px rgba(255,90,95,0.5);
    transition:background-color .3s;
    user-select: none;
  }
  #avogadroIncreaseBtn:hover {
    background-color: #ff7a7f;
  }
  #avogadro .return-btn {
    order: 1;
    margin-bottom: 1cm;
    width: 140px;
  }

  /* Balloon pop animation */
  @keyframes pop {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.5); opacity: 0.3; }
    100% { transform: scale(0); opacity: 0; }
  }
  .pop-animation {
    animation: pop 1.5s forwards;
  }

</style>
</head>
<body>

<!-- MAIN MENU -->
<div id="mainMenu">
  <h1>Chemistry Laws Simulator</h1>
  <button class="menu-button" data-mode="boyle">Boyle's Law</button>
  <button class="menu-button" data-mode="charles">Charles's Law</button>
  <button class="menu-button" data-mode="avogadro">Avogadro's Law</button>
  <div class="menu-subtitle">Choose a law to explore</div>
</div>

<!-- BOYLE MODE -->
<div id="boyle" class="gameMode">
  <div class="container">
    <h2>Boyle's Law</h2>
    <div class="slider-container">
      <label>Mass: <span id="boyleMassVal">5</span></label>
      <input type="range" id="boyleMass" min="1" max="20" step="1" value="5" />
    </div>
    <div class="slider-container">
      <label>Temperature (°C): <span id="boyleTempVal">20</span></label>
      <input type="range" id="boyleTemp" min="0" max="100" value="20" />
    </div>
    <div class="slider-container">
      <label>Ball Quantity: <span id="boyleBallQtyVal">5</span></label>
      <input type="range" id="boyleBallQty" min="1" max="20" step="1" value="5" />
    </div>
    <div class="slider-container">
      <label>Ball Speed: <span id="boyleBallSpeedVal">3</span></label>
      <input type="range" id="boyleBallSpeed" min="1" max="10" step="0.1" value="3" />
    </div>
    <canvas id="boyleCanvas" width="350" height="350"></canvas>
  </div>
  <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
</div>

<!-- CHARLES MODE -->
<div id="charles" class="gameMode">
  <h2>Charles's Law</h2>
  <div id="charlesContainer">
    <div id="charlesBalloon"></div>
    <div class="slider-container" style="width: 80%; margin-top: 30px;">
      <label>Temperature (°C): <span id="charlesTempVal">20</span></label>
      <input type="range" id="charlesTempSlider" min="0" max="100" value="20" />
    </div>
  </div>
  <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
</div>

<!-- AVOGADRO MODE -->
<div id="avogadro" class="gameMode">
  <div class="container">
    <h2>Avogadro's Law</h2>
    <div class="balloon-container">
      <div id="avogadroBalloon" class="balloon"></div>
      <div class="molecule-teller-bg">0</div>
      <div id="avogadroMoleculeCounter" class="molecule-counter">0</div>
    </div>
  </div>
  <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  <button id="avogadroIncreaseBtn">Add Molecule</button>
</div>

<script>
  // MAIN MENU and Mode switching
  const mainMenu = document.getElementById('mainMenu');
  const modes = ['boyle', 'charles', 'avogadro'];

  function showMode(mode) {
    mainMenu.style.display = 'none';
    modes.forEach(m => {
      const el = document.getElementById(m);
      if (m === mode) {
        el.classList.add('active');
      } else {
        el.classList.remove('active');
      }
    });
  }
  function returnToMenu() {
    mainMenu.style.display = 'flex';
    modes.forEach(m => document.getElementById(m).classList.remove('active'));
  }

  document.querySelectorAll('.menu-button').forEach(btn => {
    btn.addEventListener('click', () => {
      showMode(btn.dataset.mode);
    });
  });

  /* -------- BOYLE MODE -------- */
  const boyleMass = document.getElementById('boyleMass');
  const boyleTemp = document.getElementById('boyleTemp');
  const boyleMassVal = document.getElementById('boyleMassVal');
  const boyleTempVal = document.getElementById('boyleTempVal');

  const boyleBallQty = document.getElementById('boyleBallQty');
  const boyleBallQtyVal = document.getElementById('boyleBallQtyVal');
  const boyleBallSpeed = document.getElementById('boyleBallSpeed');
  const boyleBallSpeedVal = document.getElementById('boyleBallSpeedVal');

  const boyleCanvas = document.getElementById('boyleCanvas');
  const boyleCtx = boyleCanvas.getContext('2d');

  let boyleBalls = [];

  function createBoyleBalls(qty, speed) {
    boyleBalls = [];
    for (let i = 0; i < qty; i++) {
      boyleBalls.push({
        x: 30 + Math.random() * (boyleCanvas.width - 60),
        y: 30 + Math.random() * (boyleCanvas.height - 60),
        radius: 15,
        vx: (Math.random() < 0.5 ? -1 : 1) * speed * (0.5 + Math.random()),
        vy: (Math.random() < 0.5 ? -1 : 1) * speed * (0.5 + Math.random()),
      });
    }
  }

  function drawBoyle() {
    boyleCtx.clearRect(0, 0, boyleCanvas.width, boyleCanvas.height);
    // Draw container rectangle
    boyleCtx.strokeStyle = '#ff5a5f';
    boyleCtx.lineWidth = 3;
    boyleCtx.strokeRect(30, 30, boyleCanvas.width - 60, boyleCanvas.height - 60);

    // Draw balls
    boyleBalls.forEach(ball => {
      boyleCtx.beginPath();
      boyleCtx.fillStyle = `rgba(255, 90, 95, 0.7)`;
      boyleCtx.shadowColor = 'rgba(255,90,95,0.6)';
      boyleCtx.shadowBlur = 8;
      boyleCtx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
      boyleCtx.fill();
    });
  }

  function updateBoyleBalls() {
    boyleBalls.forEach(ball => {
      ball.x += ball.vx;
      ball.y += ball.vy;

      const left = 30 + ball.radius;
      const right = boyleCanvas.width - 30 - ball.radius;
      const top = 30 + ball.radius;
      const bottom = boyleCanvas.height - 30 - ball.radius;

      if (ball.x <= left || ball.x >= right) ball.vx *= -1;
      if (ball.y <= top || ball.y >= bottom) ball.vy *= -1;
    });
  }

  function boyleLoop() {
    drawBoyle();
    updateBoyleBalls();
    requestAnimationFrame(boyleLoop);
  }

  boyleMass.addEventListener('input', () => {
    boyleMassVal.textContent = boyleMass.value;
  });
  boyleTemp.addEventListener('input', () => {
    boyleTempVal.textContent = boyleTemp.value;
  });

  boyleBallQty.addEventListener('input', () => {
    boyleBallQtyVal.textContent = boyleBallQty.value;
    createBoyleBalls(Number(boyleBallQty.value), Number(boyleBallSpeed.value));
  });

  boyleBallSpeed.addEventListener('input', () => {
    boyleBallSpeedVal.textContent = boyleBallSpeed.value;
    createBoyleBalls(Number(boyleBallQty.value), Number(boyleBallSpeed.value));
  });

  // Initial setup for Boyle mode
  boyleBallQtyVal.textContent = boyleBallQty.value;
  boyleBallSpeedVal.textContent = boyleBallSpeed.value;
  createBoyleBalls(Number(boyleBallQty.value), Number(boyleBallSpeed.value));
  boyleLoop();

  /* -------- CHARLES MODE -------- */
  const charlesTempSlider = document.getElementById('charlesTempSlider');
  const charlesTempVal = document.getElementById('charlesTempVal');
  const charlesBalloon = document.getElementById('charlesBalloon');

  charlesTempSlider.addEventListener('input', () => {
    charlesTempVal.textContent = charlesTempSlider.value;

    // Balloon size scales with temperature
    // Min temp 0 => small balloon, max temp 100 => bigger balloon
    const minSize = 80;
    const maxSize = 180;
    const size = minSize + (maxSize - minSize) * (charlesTempSlider.value / 100);
    charlesBalloon.style.width = size + 'px';
    charlesBalloon.style.height = (size * 1.5) + 'px'; // height is 1.5x width
  });

  // Initialize Charles balloon size on load
  charlesTempSlider.dispatchEvent(new Event('input'));

  /* -------- AVOGADRO MODE -------- */
  const avogadroBalloon = document.getElementById('avogadroBalloon');
  const avogadroMoleculeCounter = document.getElementById('avogadroMoleculeCounter');
  const avogadroIncreaseBtn = document.getElementById('avogadroIncreaseBtn');

  let moleculeCount = 0;
  let balloonSize = 50; // start size in px

  const maxBalloonSize = 100; // max balloon diameter in px

  // Add popping sound
  const popSound = new Audio('https://actions.google.com/sounds/v1/pop/pop.ogg');

  let avogadroHoldInterval;

  function addMolecule() {
    if (balloonSize >= maxBalloonSize) return; // max size reached, no more increase

    moleculeCount++;
    balloonSize += 1;

    if (balloonSize >= maxBalloonSize) {
      balloonSize = maxBalloonSize;
      popSound.play();
      avogadroBalloon.classList.add('pop-animation');
      setTimeout(() => {
        avogadroBalloon.classList.remove('pop-animation');
        balloonSize = 50; // reset size after pop
        moleculeCount = 0;
        updateAvogadroUI();
      }, 1500);
    }

    updateAvogadroUI();
  }

  function updateAvogadroUI() {
    avogadroBalloon.style.width = balloonSize + 'px';
    avogadroBalloon.style.height = balloonSize + 'px';

    avogadroMoleculeCounter.textContent = moleculeCount;
  }

  avogadroIncreaseBtn.addEventListener('mousedown', () => {
    addMolecule();
    avogadroHoldInterval = setInterval(addMolecule, 200);
  });
  avogadroIncreaseBtn.addEventListener('mouseup', () => {
    clearInterval(avogadroHoldInterval);
  });
  avogadroIncreaseBtn.addEventListener('mouseleave', () => {
    clearInterval(avogadroHoldInterval);
  });

  // Initialize Avogadro UI
  updateAvogadroUI();

  /* -------- FALLING ATOMS BACKGROUND -------- */
  const mainMenuEl = document.getElementById('mainMenu');
  const atomSymbols = ['H', 'He', 'Li', 'C', 'O', 'N', 'Ne', 'Ar', 'Kr', 'Xe'];
  const atomCount = 40;

  function createFallingAtom() {
    const atom = document.createElement('div');
    atom.classList.add('fallingAtom');
    atom.textContent = atomSymbols[Math.floor(Math.random() * atomSymbols.length)];
    atom.style.left = Math.random() * 100 + 'vw';
    atom.style.fontSize = (8 + Math.random() * 24) + 'px';
    atom.style.animationDuration = (8 + Math.random() * 12) + 's';
    atom.style.animationDelay = Math.random() * 10 + 's';
    mainMenu.appendChild(atom);

    // Remove after animation ends to keep DOM light
    atom.addEventListener('animationend', () => {
      mainMenu.removeChild(atom);
      createFallingAtom();
    });
  }

  for (let i = 0; i < atomCount; i++) {
    createFallingAtom();
  }

</script>

</body>
</html>
