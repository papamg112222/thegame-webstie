<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Gas Laws Game</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600&display=swap');
  html, body {
    margin:0; padding:0; height:100%;
    font-family:'Montserrat',sans-serif;
    background:#1a0a3a;
    color:#fff;
    overflow:hidden;
    touch-action:manipulation;
  }
  #particleCanvas { position:fixed; top:0; left:0; width:100%; height:100%; z-index:0; }

  #mainMenu { position:relative; z-index:1; display:flex; flex-direction:column; align-items:center; justify-content:center; height:100%; text-align:center; }
  #mainMenu h1{font-size:3rem;color:#ff5a5f;margin:0}
  #mainMenu button{
    margin:12px; padding:16px 60px;
    font-size:1.2rem; color:#fff; background:#ff5a5f;
    border:none; border-radius:40px;
    box-shadow:0 4px 8px rgba(255,90,95,.4);
    cursor:pointer;
    transition:background .3s;
    user-select:none;
  }
  #mainMenu button:hover { background:#ff7a7f; }

  .mode { display:none; position:relative; z-index:1; height:100%; overflow:auto;
    padding:20px; box-sizing:border-box; background:#111; }
  .mode.active { display:block; }

  .return-btn{display:block;margin:20px auto;padding:10px 30px;background:#ff5a5f;color:#fff;
    border:none;border-radius:30px;cursor:pointer;transition:background .3s;}
  .return-btn:hover{background:#ff7a7f}

  .slider-container{margin:10px auto; width:90%;max-width:300px; color:#ff5a5f;}
  .slider-container label{display:block;font-weight:600;margin-bottom:4px;font-size:1rem;}
  input[type=range]{width:100%}

  /* Balloon shape */
  .balloon { width:100px; height:140px; background:#ff5a5f;
    border-radius:50% 50% 55% 55% / 60% 60% 40% 40%;
    position:relative; margin:20px auto; transition:150ms;}
  .balloon:after { content:''; position:absolute; bottom:-10px; left:50%; transform:translateX(-50%) rotate(45deg);
    width:20px;height:12px;background:#777;border-radius:2px;}

  .molecule-counter { position:absolute; top:10%; left:50%; transform:translateX(-50%); font-size:2rem;
    opacity:.15; pointer-events:none; user-select:none; }

  /* Dot container */
  .dot-container { background:#222; border:2px solid #444; margin:10px auto; width:90%;max-width:360px; height:250px;
    border-radius:8px; position:relative; overflow:hidden; }

  .dot{position:absolute; width:8px; height:8px; border-radius:50%; background:#00b0ff;}

  @keyframes popAnim {0%{transform:scale(1);opacity:1}100%{transform:scale(2);opacity:0}}
</style>
</head>
<body>
<canvas id="particleCanvas"></canvas>

<div id="mainMenu">
  <h1>GAS LAWS GAME</h1>
  <button onclick="start('boyle')">Boyle's Law</button>
  <button onclick="start('charles')">Charles's Law</button>
  <button onclick="start('gay')">Gay‑Lussac's Law</button>
  <button onclick="start('avogadro')">Avogadro's Law</button>
</div>

<!-- Boyle -->
<div id="boyle" class="mode">
  <h2>Boyle's Law</h2>
  <div class="slider-container"><label>Mass: <span id="bmassVal">5</span></label><input id="bmass" type="range" min="1" max="20" value="5"></div>
  <div class="slider-container"><label>Temperature: <span id="btempVal">50</span></label><input id="btemp" type="range" min="1" max="100" value="50"></div>
  <div class="dot-container" id="dotBox"></div>
  <button class="return-btn" onclick="goBack()">Return to Menu</button>
</div>

<!-- Charles -->
<div id="charles" class="mode">
  <h2>Charles's Law</h2>
  <div class="slider-container"><label>Temperature: <span id="ctempVal">20</span></label><input id="ctemp" type="range" min="0" max="100" value="20"></div>
  <div class="balloon"><div id="charMoles" class="molecule-counter">20</div></div>
  <button class="return-btn" onclick="goBack()">Return to Menu</button>
</div>

<!-- Gay -->
<div id="gay" class="mode">
  <h2>Gay‑Lussac's Law</h2>
  <p style="text-align:center">Mode not implemented yet.</p>
  <button class="return-btn" onclick="goBack()">Return to Menu</button>
</div>

<!-- Avogadro -->
<div id="avogadro" class="mode">
  <h2>Avogadro's Law</h2>
  <button class="return-btn" onclick="goBack()">Return to Menu</button>
  <button id="addMol" style="background:#ff5a5f;color:#fff;padding:12px 24px;border:none;border-radius:30px;margin:10px auto;display:block;">Add Molecule</button>
  <div class="balloon" id="avoBalloon"><div id="avoCount" class="molecule-counter">0</div></div>
</div>

<script>
// Particle background
const c=document.getElementById('particleCanvas'), ctx=c.getContext('2d');
let parts=[];
function initParts(){
  c.width=innerWidth; c.height=innerHeight;
  parts=[]; for(let i=0;i<60;i++){
    parts.push({x:Math.random()*c.width, y:Math.random()*c.height,
      sz:10+Math.random()*10, sp:1+Math.random()*1.5,
      ang:Math.random()*Math.PI*2, asp:0.02+Math.random()*0.02});
  }
}
function draw(){
  ctx.clearRect(0,0,c.width,c.height);
  parts.forEach(p=>{
    p.y+=p.sp; p.ang+=p.asp;
    if(p.y>c.height+p.sz) p.y=-p.sz;
    ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.ang);
    ctx.fillStyle='#ff5a5f';
    ctx.fillRect(-p.sz/2,-p.sz/2,p.sz,p.sz);
    ctx.restore();
  });
  requestAnimationFrame(draw);
}
window.onresize=initParts;
initParts(); draw();

// Mode control
function start(m){
  document.getElementById('mainMenu').style.display='none';
  ['boyle','charles','gay','avogadro'].forEach(id=>document.getElementById(id).style.display='none');
  document.getElementById(m).style.display='block';
  if(m==='boyle') initBoyle();
  if(m==='charles') initCharles();
  if(m==='avogadro') initAvogadro();
}
function goBack(){
  document.getElementById('mainMenu').style.display='flex';
  ['boyle','charles','gay','avogadro'].forEach(id=>document.getElementById(id).style.display='none');
}

// Boyle with dots
let dots=[], animId;
function initBoyle(){
  cancelAnimationFrame(animId);
  const box=document.getElementById('dotBox');
  box.innerHTML=''; dots=[];
  let mass=document.getElementById('bmass'), temp=document.getElementById('btemp');
  function setupDots(){
    box.innerHTML=''; dots=[];
    let count=+mass.value;
    for(let i=0;i<count;i++){
      let d=document.createElement('div');
      d.className='dot'; box.appendChild(d);
      dots.push({el:d,
        x:Math.random()*(box.clientWidth-8),
        y:Math.random()*(box.clientHeight-8),
        vx:(Math.random()-0.5)*2, vy:(Math.random()-0.5)*2
      });
    }
  }
  function animate(){
    const t=+temp.value/50, m=+mass.value;
    dots.forEach(o=>{
      o.x += o.vx * t/m;
      o.y += o.vy * t/m;
      if(o.x<0||o.x>box.clientWidth-8) o.vx*=-1;
      if(o.y<0||o.y>box.clientHeight-8) o.vy*=-1;
      o.el.style.left=o.x+'px'; o.el.style.top=o.y+'px';
    });
    animId=requestAnimationFrame(animate);
  }
  mass.oninput=()=>{document.getElementById('bmassVal').textContent=mass.value; setupDots();}
  temp.oninput=()=>document.getElementById('btempVal').textContent=temp.value;
  setupDots(); animate();
}

// Charles
function initCharles(){
  const t=document.getElementById('ctemp'), out=document.getElementById('ctempVal');
  t.oninput=()=>{
    out.textContent=t.value;
    const b=document.querySelector('#charles .balloon');
    let v=80 + t.value*1.2;
    if(v>200)v=200;
    b.style.width=v+'px'; b.style.height=(v*1.2)+'px';
    document.getElementById('charMoles').textContent=t.value;
  };
  t.oninput(); 
}

// Avogadro
function initAvogadro(){
  let c=0;
  const btn=document.getElementById('addMol'),
        b=document.getElementById('avoBalloon'),
        ct=document.getElementById('avoCount');
  btn.onclick=()=>{
    c++;
    ct.textContent=c;
    let sz=100 + c*1.5;
    b.style.width=sz+'px'; b.style.height=(sz*1.4)+'px';
    if(c>=100){
      b.style.animation='popAnim .5s forwards'; 
      new Audio('https://freesound.org/data/previews/341/341695_3248244-lq.mp3').play();
      setTimeout(()=>{
        c=0; ct.textContent=c;
        b.style.animation=''; b.style.width='100px'; b.style.height='140px';
      },600);
    }
  };
}
</script>
</body>
</html>
