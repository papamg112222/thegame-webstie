const container = document.getElementById('container');
const massSlider = document.getElementById('massSlider');
const tempSlider = document.getElementById('tempSlider');
const massValue = document.getElementById('massValue');
const tempValue = document.getElementById('tempValue');

let dots = [];
let speedFactor = tempSlider.value / 50; // Initial speed factor based on temperature
let maxDots = 100; // Maximum number of dots

function createDot() {
  const dot = document.createElement('div');
  dot.classList.add('dot');
  container.appendChild(dot);
  return {
    el: dot,
    x: Math.random() * container.offsetWidth,
    y: Math.random() * container.offsetHeight,
    vx: (Math.random() - 0.5) * speedFactor * 4,
    vy: (Math.random() - 0.5) * speedFactor * 4
  };
}

function updateDots() {
  dots.forEach(dot => {
    dot.x += dot.vx;
    dot.y += dot.vy;

    // Bounce off walls
    if (dot.x < 0 || dot.x > container.offsetWidth - 8) dot.vx *= -1;
    if (dot.y < 0 || dot.y > container.offsetHeight - 8) dot.vy *= -1;

    dot.el.style.transform = `translate(${dot.x}px, ${dot.y}px)`;
  });
}

function adjustDots() {
  const desiredCount = Math.min(Math.floor(massSlider.value / 10), maxDots);
  if (desiredCount > dots.length) {
    for (let i = dots.length; i < desiredCount; i++) {
      dots.push(createDot());
    }
  } else if (desiredCount < dots.length) {
    for (let i = dots.length; i > desiredCount; i--) {
      container.removeChild(dots.pop().el);
    }
  }
}

massSlider.addEventListener('input', () => {
  massValue.textContent = massSlider.value;
  adjustDots();
});

tempSlider.addEventListener('input', () => {
  tempValue.textContent = tempSlider.value;
  speedFactor = tempSlider.value / 50;
  dots.forEach(dot => {
    dot.vx = (Math.random() - 0.5) * speedFactor * 4;
    dot.vy = (Math.random() - 0.5) * speedFactor * 4;
  });
});

function animate() {
  updateDots();
  requestAnimationFrame(animate);
}

adjustDots();
animate();
