<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gas Laws Game - Boyle</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600&display=swap');
  html, body { margin:0; padding:0; height:100%; font-family:'Montserrat',sans-serif; background:#1a0a3a; overflow:hidden; color:white; }
  #particleCanvas { position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:0;pointer-events:none; }

  #mainMenu { position:relative; z-index:1; height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; }
  #mainMenu h1 { font-weight:600; font-size:4rem; margin-bottom:0.3em; letter-spacing:5px; color:#ff5a5f; }
  #mainMenu h3 { font-weight:300; font-size:1.2rem; margin-bottom:2em; color:#ff7a7f; }
  #mainMenu button { background:#ff5a5f; border:none; border-radius:50px; color:white; font-size:1.5rem; padding:16px 80px; margin:12px 0; cursor:pointer; box-shadow:0 4px 8px rgba(255,90,95,0.4); transition:background-color .3s; }
  #mainMenu button:hover { background:#ff7a7f; }

  .gameMode { display:none; position:relative; z-index:2; height:100vh; padding:20px; background:#111; overflow:auto; box-sizing:border-box; }
  .return-btn { margin-top:20px; padding:10px 20px; font-size:16px; background:#ff5a5f; color:white; border:none; border-radius:5px; cursor:pointer; }

  /* Boyle specific */
  #boyleContainer {
    margin: 20px auto;
    width: 500px; height: 350px;
    background: #222;
    border: 2px solid #ff5a5f;
    border-radius: 15px;
    position: relative;
    overflow: hidden;
  }

  .slider-container {
    margin: 15px auto;
    width: 300px;
    color: #ff5a5f;
  }
  .slider-container label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
  }
  input[type=range] {
    width: 100%;
  }

  /* Molecule balls */
  .molecule {
    position: absolute;
    border-radius: 50%;
    background-color: #ff5a5f;
    box-shadow: 0 0 6px #ff7a7f;
    pointer-events:none;
  }
</style>
</head>
<body>

<canvas id="particleCanvas"></canvas>

<!-- MAIN MENU -->
<div id="mainMenu">
  <h1>GAS LAWS GAME</h1>
  <h3>Choose your mode</h3>
  <button onclick="showMode('boyle')">Boyle's Law</button>
  <button onclick="showMode('charles')">Charles' Law</button>
  <button onclick="showMode('gayLussac')">Gay‑Lussac's Law</button>
  <button onclick="showMode('avogadro')">Avogadro's Law</button>
</div>

<!-- BOYLE -->
<div id="boyle" class="gameMode">
  <h2>Boyle's Law</h2>
  <div class="slider-container">
    <label for="boyleMass">Mass: <span id="boyleMassVal">5</span></label>
    <input type="range" id="boyleMass" min="1" max="20" step="1" value="5">
  </div>
  <div class="slider-container">
    <label for="boyleTemp">Temperature: <span id="boyleTempVal">20</span> °C</label>
    <input type="range" id="boyleTemp" min="0" max="100" step="1" value="20">
  </div>
  <div id="boyleContainer"></div>
  <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
</div>

<!-- Other modes here (unchanged, omitted for brevity) -->

<script>
  // === Animated Particles Background (unchanged) ===
  const canvas = document.getElementById('particleCanvas'), ctx = canvas.getContext('2d');
  let particles = [], width, height;
  function initParticles() {
    width = window.innerWidth; height = window.innerHeight;
    canvas.width = width; canvas.height = height;
    particles = [];
    for (let i = 0; i < 80; i++) {
      particles.push({
        x: Math.random()*width,
        y: Math.random()*height,
        radius: Math.random()*6 + 2,
        speedY: Math.random()*1.5 + 0.5,
        speedX: (Math.random()-0.5)*0.5,
        color: '#ff5a5f',
        alpha: Math.random()*0.5 + 0.3,
        type: Math.random() > 0.5 ? 'circle' : 'atom'
      });
    }
  }
  function drawAtom(x, y, r) {
    ctx.strokeStyle = '#ff7a7f';
    ctx.lineWidth = 1.2;
    ctx.beginPath(); ctx.arc(x, y, r*0.6, 0, Math.PI*2);
    ctx.fillStyle = 'rgba(255,122,127,0.8)'; ctx.fill(); ctx.closePath();
    ctx.beginPath(); ctx.ellipse(x, y, r*1.2, r*0.5, 0, 0, Math.PI*2); ctx.stroke();
    ctx.beginPath(); ctx.ellipse(x, y, r*0.5, r*1.2, Math.PI/4, 0, Math.PI*2); ctx.stroke();
  }
  function animateParticles() {
    ctx.clearRect(0, 0, width, height);
    particles.forEach(p => {
      p.y += p.speedY;
      p.x += p.speedX;
      if (p.y - p.radius > height) p.y = -p.radius;
      if (p.x - p.radius > width) p.x = -p.radius;
      if (p.x + p.radius < 0) p.x = width + p.radius;
      ctx.globalAlpha = p.alpha;
      if (p.type === 'circle') {
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.radius, 0, Math.PI*2);
        ctx.fillStyle = p.color;
        ctx.fill();
      } else {
        drawAtom(p.x, p.y, p.radius);
      }
    });
    ctx.globalAlpha = 1;
    requestAnimationFrame(animateParticles);
  }
  window.addEventListener('resize', initParticles);
  initParticles(); animateParticles();

  // === Navigation ===
  const modes = ['boyle', 'charles', 'gayLussac', 'avogadro'];
  function showMode(id) {
    document.getElementById('mainMenu').style.display = 'none';
    modes.forEach(m => {
      const el = document.getElementById(m);
      if(el) el.style.display = (m === id) ? 'block' : 'none';
    });
    if (id === 'boyle') setupBoyle();
    // Setup others...
  }
  function returnToMenu() {
    document.getElementById('mainMenu').style.display = 'flex';
    modes.forEach(m => {
      const el = document.getElementById(m);
      if(el) el.style.display = 'none';
    });
    // Stop Boyle animation when leaving
    stopBoyleAnimation();
  }

  // === Boyle’s Law with balls in container ===
  const boyleMassSlider = document.getElementById('boyleMass'),
        boyleTempSlider = document.getElementById('boyleTemp'),
        boyleMassVal = document.getElementById('boyleMassVal'),
        boyleTempVal = document.getElementById('boyleTempVal'),
        boyleContainer = document.getElementById('boyleContainer');

  let molecules = [];
  let animationId;
  const containerRect = { width: 500, height: 350 };
  
  class Molecule {
    constructor(container) {
      this.container = container;
      this.radius = 8 + Math.random() * 4; // 8-12 px radius
      this.x = Math.random() * (containerRect.width - 2*this.radius) + this.radius;
      this.y = Math.random() * (containerRect.height - 2*this.radius) + this.radius;
      this.speedX = (Math.random() - 0.5) * 2;
      this.speedY = (Math.random() - 0.5) * 2;
      this.elem = document.createElement('div');
      this.elem.className = 'molecule';
      this.elem.style.width = this.radius*2 + 'px';
      this.elem.style.height = this.radius*2 + 'px';
      container.appendChild(this.elem);
      this.updatePosition();
    }
    updatePosition() {
      this.elem.style.left = this.x - this.radius + 'px';
      this.elem.style.top = this.y - this.radius + 'px';
    }
    move(speedMultiplier) {
      this.x += this.speedX * speedMultiplier;
      this.y += this.speedY * speedMultiplier;

      // Bounce off walls
      if (this.x - this.radius < 0) {
        this.x = this.radius;
        this.speedX = -this.speedX;
      }
      if (this.x + this.radius > containerRect.width) {
        this.x = containerRect.width - this.radius;
        this.speedX = -this.speedX;
      }
      if (this.y - this.radius < 0) {
        this.y = this.radius;
        this.speedY = -this.speedY;
      }
      if (this.y + this.radius > containerRect.height) {
        this.y = containerRect.height - this.radius;
        this.speedY = -this.speedY;
      }

      this.updatePosition();
    }
    remove() {
      this.elem.remove();
    }
  }

  function setupBoyle() {
    boyleMassSlider.oninput = boyleTempSlider.oninput = updateBoyle;
    updateBoyle();
  }

  function updateBoyle() {
    const mass = +boyleMassSlider.value;
    const temp = +boyleTempSlider.value;
    boyleMassVal.textContent = mass;
    boyleTempVal.textContent = temp;

    // Adjust molecule count
    adjustMolecules(mass);

    // Speed calculation:
    // Mass affects speed inversely: more mass = slower speed base (1 / mass)
    // Temp affects speed directly: higher temp = faster (temp factor)
    // We'll calculate a speedMultiplier that combines both effects
    const massFactor = 1 / mass;           // slows down as mass increases
    const tempFactor = 0.5 + temp / 100;   // from 0.5 (at 0°C) to 1.5 (at 100°C)

    const speedMultiplier = massFactor * tempFactor;

    animateMolecules(speedMultiplier);
  }

  // Adjust number of molecules to match mass slider
  function adjustMolecules(targetCount) {
    while (molecules.length < targetCount) {
      molecules.push(new Molecule(boyleContainer));
    }
    while (molecules.length > targetCount) {
      const m = molecules.pop();
      m.remove();
    }
  }

  let lastSpeedMultiplier = 0;
  let animationRunning = false;

  function animateMolecules(speedMultiplier) {
    lastSpeedMultiplier = speedMultiplier;

    if (!animationRunning) {
      animationRunning = true;
      function animate() {
        molecules.forEach(m => m.move(lastSpeedMultiplier));
        animationId = requestAnimationFrame(animate);
      }
      animate();
    }
  }

  function stopBoyleAnimation() {
    if(animationId) {
      cancelAnimationFrame(animationId);
      animationId = null;
      animationRunning = false;
    }
    // Remove all molecules visually
    molecules.forEach(m => m.remove());
    molecules = [];
  }

</script>
</body>
</html>
