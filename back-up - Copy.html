// Variables for animation & effects
let moveCycle = 0;
let isDashing = false;
let dashTimer = 0;
let dashDuration = 15;

function update() {
  moveCycle += 0.1;

  // Movement example: smooth swing for arms and legs
  greenPlayer.armAngle = Math.sin(moveCycle) * 30;
  greenPlayer.legAngle = Math.sin(moveCycle + Math.PI) * 30;  // opposite phase for legs

  bluePlayer.armAngle = Math.sin(moveCycle + Math.PI) * 30;
  bluePlayer.legAngle = Math.sin(moveCycle) * 30;

  // Dash logic
  if (isDashing) {
    dashTimer--;
    if (dashTimer <= 0) {
      isDashing = false;
    }
    // Add dash trail effect (pseudo code)
    createDashTrail(greenPlayer.position);
  }

  // Call render to draw everything with updated states
  render();
}

function startDash(player) {
  isDashing = true;
  dashTimer = dashDuration;
  // Give player a speed burst
  player.speed = player.baseSpeed * 3;
}

function render() {
  clearCanvas();

  // Draw health bars outside at top
  drawHealthBar(greenPlayer.health, 20, 20, "green");
  drawHealthBar(bluePlayer.health, canvas.width - 220, 20, "cyan");

  // Draw stickmen with smooth limb angles
  drawStickman(greenPlayer, greenPlayer.armAngle, greenPlayer.legAngle);
  drawStickman(bluePlayer, bluePlayer.armAngle, bluePlayer.legAngle);

  // Draw weapon effects when attacking
  if (greenPlayer.isAttacking) drawWeaponGlow(greenPlayer);
  if (bluePlayer.isAttacking) drawWeaponGlow(bluePlayer);

  // Dash trail effect during dash
  if (isDashing) drawDashTrail(greenPlayer.position);
}

function drawStickman(player, armAngle, legAngle) {
  // Draw head, torso, legs, arms
  // Use armAngle, legAngle for rotation of limbs
  // Add slight vertical bobbing on position.y based on sine(moveCycle)
}

function drawHealthBar(health, x, y, color) {
  ctx.fillStyle = color;
  ctx.fillRect(x, y, health * 2, 20);  // health scale
  ctx.strokeRect(x, y, 200, 20);
}

function drawWeaponGlow(player) {
  // Draw glowing trail around weapons
  // Example: semi-transparent shapes with additive blending
}

function createDashTrail(position) {
  // Add particle or blur effect behind player for dash effect
}

function drawDashTrail(position) {
  // Render the trail particles or glow behind the player
}
