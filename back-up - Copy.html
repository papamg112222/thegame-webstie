<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gas Laws Game</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600&display=swap');

    html, body { margin:0; padding:0; height:100%; font-family:'Montserrat',sans-serif; background:#1a0a3a; overflow:hidden; color:white; }
    #particleCanvas { position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:0;pointer-events:none; }

    #mainMenu {
      position:relative; z-index:1; height:100vh;
      display:flex; flex-direction:column; justify-content:center; align-items:center;
    }
    #mainMenu h1 { font-weight:600; font-size:4rem; margin-bottom:0.3em; letter-spacing:5px; color:#ff5a5f; }
    #mainMenu h3 { font-weight:300; font-size:1.2rem; margin-bottom:2em; color:#ff7a7f; }
    #mainMenu button {
      background:#ff5a5f;
      border:none;
      border-radius:50px;
      color:white;
      font-size:1.5rem;
      padding:16px 80px;
      margin:12px 0;
      cursor:pointer;
      box-shadow:0 4px 8px rgba(255,90,95,0.4);
      transition:background-color .3s;
    }
    #mainMenu button:hover { background:#ff7a7f; }

    .gameMode {
      display:none;
      position:relative;
      z-index:2;
      height:100vh;
      padding:20px;
      background:#111;
      overflow:auto;
      box-sizing:border-box;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Boyle container bigger and spaced from return button */
    #boyle .container {
      background: #222;
      border-radius: 12px;
      padding: 20px;
      width: 350px;
      height: 450px; /* increased height */
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      margin-bottom: 20px; /* spacing below container so return button won't overlap */
    }

    .return-btn {
      margin-top: 0; /* remove default margin */
      padding: 10px 20px;
      font-size: 16px;
      background: #ff5a5f;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      align-self: center;
      width: 140px;
      z-index: 10;
    }

    .slider-container { margin: 15px 0; width: 300px; color:#ff5a5f; }
    .slider-container label { display: block; margin-bottom: 6px; font-weight: 600; }
    input[type=range] { width: 100%; }

    /* Balloon container styling */
    .balloon-container {
      position: relative;
      width: 250px;
      height: 250px;
      margin: 10px auto;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .balloon {
      border-radius: 50% / 60%;
      transition: width 0.3s, height 0.3s, background-color 0.3s;
      position: relative;
      z-index: 10;
    }
    .molecule-teller-bg, .molecule-counter {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      text-shadow: 0 0 10px rgba(255,255,255,0.7);
      user-select: none;
      font-weight: 900;
      z-index: 1;
    }
    .molecule-teller-bg {
      font-size: 180px;
      font-weight: 900;
      opacity: 0.1;
      letter-spacing: 20px;
    }
    .molecule-counter {
      font-size: 48px;
      font-weight: 600;
      top: 60px;
    }

    /* Charles balloon - 75% transparent */
    #charlesBalloon {
      background-color: rgba(255, 90, 95, 0.25) !important; /* 75% transparent */
      box-shadow: 0 0 15px rgba(255, 90, 95, 0.4);
    }

    /* Avogadro balloon - 75% transparent */
    #avogadroBalloon {
      background-color: rgba(255, 90, 95, 0.25) !important;
    }

    /* Avogadro button above container with 1cm margin, return button below container with 1cm margin */
    #avogadro .container {
      position: relative;
      background: #222;
      border-radius: 12px;
      padding: 20px;
      width: 350px;
      height: 300px;
      margin-bottom: 10px; /* small margin bottom for spacing return button */
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    #avogadroIncreaseBtn {
      position: relative;
      bottom: 10px; /* place button above container by 1cm approx */
      margin-bottom: 1cm;
      width: auto;
      font-size: 1.3rem;
      background:#ff5a5f;
      border:none;
      border-radius:30px;
      color:white;
      padding:12px 30px;
      cursor:pointer;
      box-shadow:0 3px 7px rgba(255,90,95,0.5);
      transition:background-color .3s;
      user-select: none;
    }
    #avogadroIncreaseBtn:hover { background:#ff7a7f; }

    #avogadro .return-btn {
      margin-top: 1cm;
      width: 150px;
    }

    /* Member game styling */
    #memberGame .box {
      width: 300px;
      height: 300px;
      background: linear-gradient(135deg, #ff5a5f, #ff7a7f);
      border-radius: 12px;
      position: relative;
      margin-bottom: 20px;
    }
    #memberGame .line {
      position: absolute;
      width: 2px;
      height: 100%;
      background: rgba(255,255,255,0.2);
    }
    #memberGame .line:nth-child(1) { left: 10%; }
    #memberGame .line:nth-child(2) { left: 25%; }
    #memberGame .line:nth-child(3) { left: 40%; }
    #memberGame .line:nth-child(4) { left: 55%; }
    #memberGame .line:nth-child(5) { left: 70%; }
    #memberGame .line:nth-child(6) { left: 85%; }

  </style>
</head>
<body>
  <canvas id="particleCanvas"></canvas>

  <div id="mainMenu">
    <h1>Gas Laws Game</h1>
    <h3>Learn Boyle, Charles, Gay-Lussac & Avogadro</h3>
    <button onclick="showMode('boyle')">Boyle's Law</button>
    <button onclick="showMode('charles')">Charles' Law</button>
    <button onclick="showMode('gayLussac')">Gay-Lussac's Law</button>
    <button onclick="showMode('avogadro')">Avogadro's Law</button>
    <button id="memberBtn">Member Area</button>
  </div>

  <div id="boyle" class="gameMode">
    <div class="container">
      <canvas id="boyleCanvas" width="250" height="350" style="border-radius:12px; background:#222;"></canvas>

      <div class="slider-container">
        <label for="boyleMass">Mass (Pressure)</label>
        <input type="range" min="5" max="30" id="boyleMass" value="15" />
        <span id="boyleMassVal">15</span>
      </div>

      <div class="slider-container">
        <label for="boyleTemp">Temperature</label>
        <input type="range" min="20" max="60" id="boyleTemp" value="30" />
        <span id="boyleTempVal">30</span>
      </div>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <div id="charles" class="gameMode">
    <h2>Charles' Law</h2>
    <div class="balloon-container">
      <div id="charlesBalloon" class="balloon" style="width:150px; height:200px; background-color: rgba(255, 90, 95, 0.25); box-shadow: 0 0 15px rgba(255, 90, 95, 0.4);"></div>
      <div class="molecule-teller-bg">N<sub>2</sub></div>
      <div class="molecule-counter">28</div>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <div id="gayLussac" class="gameMode">
    <h2>Gay-Lussac's Law</h2>
    <p style="padding: 0 20px;">Content coming soon...</p>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <div id="avogadro" class="gameMode">
    <button id="avogadroIncreaseBtn">Increase Molecules</button>
    <div class="container" style="text-align:center;">
      <div id="avogadroBalloon" class="balloon" style="width: 180px; height: 220px; background-color: rgba(255, 90, 95, 0.25); box-shadow: 0 0 15px rgba(255, 90, 95, 0.4);"></div>
      <div class="molecule-teller-bg">N<sub>2</sub></div>
      <div class="molecule-counter" id="avogadroCount">15</div>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <div id="memberGame" class="gameMode">
    <h2>Member Area</h2>
    <div class="box">
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <script>
    // Show/hide game modes
    function showMode(mode) {
      document.getElementById('mainMenu').style.display = 'none';
      const modes = document.querySelectorAll('.gameMode');
      modes.forEach(m => m.style.display = 'none');
      const selected = document.getElementById(mode);
      if (selected) selected.style.display = 'flex';
    }
    function returnToMenu() {
      const modes = document.querySelectorAll('.gameMode');
      modes.forEach(m => m.style.display = 'none');
      document.getElementById('mainMenu').style.display = 'flex';
    }

    // Boyle sliders updates
    const boyleMass = document.getElementById('boyleMass');
    const boyleMassVal = document.getElementById('boyleMassVal');
    boyleMass.addEventListener('input', () => {
      boyleMassVal.textContent = boyleMass.value;
    });
    const boyleTemp = document.getElementById('boyleTemp');
    const boyleTempVal = document.getElementById('boyleTempVal');
    boyleTemp.addEventListener('input', () => {
      boyleTempVal.textContent = boyleTemp.value;
    });

    // Avogadro increase molecules
    const avogadroCount = document.getElementById('avogadroCount');
    let avogadroMolecules = 15;
    document.getElementById('avogadroIncreaseBtn').addEventListener('click', () => {
      avogadroMolecules += 5;
      if (avogadroMolecules > 50) avogadroMolecules = 15;
      avogadroCount.textContent = avogadroMolecules;
    });


    // ========== PARTICLE CANVAS ==========

    const canvas = document.getElementById('particleCanvas');
    const ctx = canvas.getContext('2d');

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // Particle class (for falling atoms and new shapes)
    class Particle {
      constructor(x, y, size, speedY, type) {
        this.x = x;
        this.y = y;
        this.size = size;
        this.speedY = speedY;
        this.type = type; // 'atom' or 'spark' (new)
        this.alpha = 1;
        this.sizeChange = 0;
      }

      update() {
        this.y += this.speedY;
        // Slowly fade out as it falls near bottom
        if (this.y > canvas.height * 0.8) {
          this.alpha -= 0.01;
          if (this.alpha < 0) this.alpha = 0;
          this.sizeChange = -0.03;
        } else if (this.alpha < 1) {
          this.alpha += 0.02;
          this.sizeChange = 0.02;
        }
        this.size += this.sizeChange;
        if (this.size < 2) this.size = 2;
      }

      draw() {
        ctx.save();
        ctx.globalAlpha = this.alpha;
        if (this.type === 'atom') {
          // Draw a small glowing circle with subtle color variation
          const gradient = ctx.createRadialGradient(this.x, this.y, 1, this.x, this.y, this.size);
          gradient.addColorStop(0, 'rgba(255,90,95,1)');
          gradient.addColorStop(1, 'rgba(255,90,95,0)');
          ctx.fillStyle = gradient;
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
          ctx.fill();

          // White core dot
          ctx.fillStyle = 'rgba(255,255,255,0.8)';
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.size * 0.4, 0, Math.PI * 2);
          ctx.fill();

        } else if (this.type === 'spark') {
          // New object: a 5-point star falling slowly, glowing
          ctx.fillStyle = `rgba(255, 150, 100, ${this.alpha})`;
          ctx.shadowColor = 'rgba(255, 150, 100, 0.7)';
          ctx.shadowBlur = 8;
          drawStar(ctx, this.x, this.y, 5, this.size, this.size/2);
        }
        ctx.restore();
      }
    }

    // Helper to draw star
    function drawStar(ctx, cx, cy, spikes, outerRadius, innerRadius) {
      let rot = Math.PI / 2 * 3;
      let x = cx;
      let y = cy;
      let step = Math.PI / spikes;

      ctx.beginPath();
      ctx.moveTo(cx, cy - outerRadius);
      for(let i = 0; i < spikes; i++){
        x = cx + Math.cos(rot) * outerRadius;
        y = cy + Math.sin(rot) * outerRadius;
        ctx.lineTo(x, y);
        rot += step;

        x = cx + Math.cos(rot) * innerRadius;
        y = cy + Math.sin(rot) * innerRadius;
        ctx.lineTo(x, y);
        rot += step;
      }
      ctx.lineTo(cx, cy - outerRadius);
      ctx.closePath();
      ctx.fill();
    }

    // Create particles
    const particles = [];
    const maxParticles = 70;

    function createParticle() {
      // Random x, starting above the screen
      const x = Math.random() * canvas.width;
      const y = -20;
      // Size from 4 to 10 for atoms, 6-14 for sparks
      const type = Math.random() < 0.7 ? 'atom' : 'spark'; // 70% atoms, 30% sparks
      let size, speedY;
      if (type === 'atom') {
        size = 4 + Math.random() * 6;
        speedY = 0.3 + Math.random() * 0.5; // slow fall
      } else {
        size = 6 + Math.random() * 8;
        speedY = 0.2 + Math.random() * 0.3; // even slower sparks
      }
      particles.push(new Particle(x, y, size, speedY, type));
    }

    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Add new particles gradually
      if (particles.length < maxParticles) {
        if (Math.random() < 0.3) createParticle(); // limit rate of creation
      }

      // Update and draw all particles
      for(let i = particles.length -1; i >= 0; i--) {
        const p = particles[i];
        p.update();
        p.draw();

        // Remove particles that have fallen below the screen and fully faded out
        if (p.y - p.size > canvas.height || p.alpha <= 0) {
          particles.splice(i, 1);
        }
      }

      requestAnimationFrame(animate);
    }

    animate();

  </script>
</body>
</html>
