<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gas Laws Game</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600&display=swap');

    html, body { margin:0; padding:0; height:100%; font-family:'Montserrat',sans-serif; background:#1a0a3a; overflow:hidden; color:white; }
    #particleCanvas { position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:0;pointer-events:none; }

    #mainMenu {
      position:relative; z-index:1; height:100vh;
      display:flex; flex-direction:column; justify-content:center; align-items:center;
    }
    #mainMenu h1 { font-weight:600; font-size:4rem; margin-bottom:0.3em; letter-spacing:5px; color:#ff5a5f; }
    #mainMenu h3 { font-weight:300; font-size:1.2rem; margin-bottom:2em; color:#ff7a7f; }
    #mainMenu button {
      background:#ff5a5f;
      border:none;
      border-radius:50px;
      color:white;
      font-size:1.5rem;
      padding:16px 80px;
      margin:12px 0;
      cursor:pointer;
      box-shadow:0 4px 8px rgba(255,90,95,0.4);
      transition:background-color .3s;
    }
    #mainMenu button:hover { background:#ff7a7f; }

    .gameMode {
      display:none;
      position:relative;
      z-index:2;
      height:100vh;
      padding:20px;
      background:#111;
      overflow:auto;
      box-sizing:border-box;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Boyle container bigger and spaced from return button */
    #boyle .container {
      background: #222;
      border-radius: 12px;
      padding: 20px;
      width: 350px;
      height: 450px; /* increased height */
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      margin-bottom: 20px; /* spacing below container so return button won't overlap */
    }

    .return-btn {
      margin-top: 0; /* remove default margin */
      padding: 10px 20px;
      font-size: 16px;
      background: #ff5a5f;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      align-self: center;
      width: 140px;
      z-index: 10;
    }

    .slider-container { margin: 15px 0; width: 300px; color:#ff5a5f; }
    .slider-container label { display: block; margin-bottom: 6px; font-weight: 600; }
    input[type=range] { width: 100%; }

    /* Balloon container styling */
    .balloon-container {
      position: relative;
      width: 250px;
      height: 250px;
      margin: 10px auto;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .balloon {
      border-radius: 50% / 60%;
      transition: width 0.3s, height 0.3s, background-color 0.3s;
      position: relative;
      z-index: 10;
    }
    .molecule-teller-bg, .molecule-counter {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      text-shadow: 0 0 10px rgba(255,255,255,0.7);
      user-select: none;
      font-weight: 900;
      z-index: 1;
    }
    .molecule-teller-bg {
      font-size: 180px;
      font-weight: 900;
      opacity: 0.1;
      letter-spacing: 20px;
    }
    .molecule-counter {
      font-size: 48px;
      font-weight: 600;
      top: 60px;
    }

    /* Charles balloon - 75% transparent */
    #charlesBalloon {
      background-color: rgba(255, 90, 95, 0.25) !important; /* 75% transparent */
      box-shadow: 0 0 15px rgba(255, 90, 95, 0.4);
    }

    /* Avogadro balloon - 75% transparent */
    #avogadroBalloon {
      background-color: rgba(255, 90, 95, 0.25) !important;
    }

    /* Avogadro button above container with 1cm margin, return button below container with 1cm margin */
    #avogadro .container {
      position: relative;
      background: #222;
      border-radius: 12px;
      padding: 20px;
      width: 350px;
      height: 300px;
      margin-bottom: 10px; /* small margin bottom for spacing return button */
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    #avogadroIncreaseBtn {
      position: relative;
      bottom: 10px; /* place button above container by 1cm approx */
      margin-bottom: 1cm;
      width: auto;
      font-size: 1.3rem;
      background:#ff5a5f;
      border:none;
      border-radius:30px;
      color:white;
      padding:12px 30px;
      cursor:pointer;
      box-shadow:0 3px 7px rgba(255,90,95,0.5);
      transition:background-color .3s;
      user-select: none;
    }
    #avogadroIncreaseBtn:hover { background:#ff7a7f; }

    #avogadro .return-btn {
      margin-top: 1cm;
      width: 150px;
    }

    /* Member game styling */
    #memberGame .box {
      width: 300px;
      height: 300px;
      background: linear-gradient(135deg, #ff5a5f, #ff7a7f);
      border-radius: 12px;
      position: relative;
      margin-bottom: 20px;
    }
    #memberGame .line {
      position: absolute;
      width: 2px;
      height: 100%;
      background: rgba(255,255,255,0.2);
    }
    #memberGame .line:nth-child(1) { left: 10%; }
    #memberGame .line:nth-child(2) { left: 25%; }
    #memberGame .line:nth-child(3) { left: 40%; }
    #memberGame .line:nth-child(4) { left: 55%; }
    #memberGame .line:nth-child(5) { left: 70%; }
    #memberGame .line:nth-child(6) { left: 85%; }

  </style>
</head>
<body>
  <canvas id="particleCanvas"></canvas>

  <div id="mainMenu">
    <h1>Gas Laws Game</h1>
    <h3>Learn Boyle, Charles, Gay-Lussac & Avogadro</h3>
    <button onclick="showMode('boyle')">Boyle's Law</button>
    <button onclick="showMode('charles')">Charles' Law</button>
    <button onclick="showMode('gayLussac')">Gay-Lussac's Law</button>
    <button onclick="showMode('avogadro')">Avogadro's Law</button>
    <button id="memberBtn">Member Area</button>
  </div>

  <div id="boyle" class="gameMode">
    <div class="container">
      <canvas id="boyleCanvas" width="250" height="350" style="border-radius:12px; background:#222;"></canvas>

      <div class="slider-container">
        <label for="boyleMass">Mass (Pressure)</label>
        <input type="range" min="5" max="30" id="boyleMass" value="15" />
        <span id="boyleMassVal">15</span>
      </div>

      <div class="slider-container">
        <label for="boyleTemp">Temperature</label>
        <input type="range" min="20" max="60" id="boyleTemp" value="30" />
        <span id="boyleTempVal">30</span>
      </div>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <div id="charles" class="gameMode">
    <h2>Charles' Law</h2>
    <div class="balloon-container">
      <div id="charlesBalloon" class="balloon" style="width:150px; height:200px; background-color: rgba(255, 90, 95, 0.25); box-shadow: 0 0 15px rgba(255, 90, 95, 0.4);"></div>
      <div class="molecule-teller-bg">100</div>
      <div class="molecule-counter">100</div>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <div id="gayLussac" class="gameMode">
    <h2>Gay-Lussac's Law</h2>
    <p>Coming Soon...</p>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <div id="avogadro" class="gameMode">
    <button id="avogadroIncreaseBtn">Increase Molecules</button>
    <div class="container">
      <div id="avogadroBalloon" class="balloon" style="width:150px; height:200px; background-color: rgba(255, 90, 95, 0.25);"></div>
      <div class="molecule-teller-bg">100</div>
      <div class="molecule-counter">100</div>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <div id="memberGame" class="gameMode">
    <h2>Member Area</h2>
    <div class="box">
      <div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <script>
    // Basic mode switching
    function showMode(mode) {
      document.querySelectorAll('.gameMode').forEach(el => el.style.display = 'none');
      document.getElementById('mainMenu').style.display = 'none';
      document.getElementById(mode).style.display = 'flex';
    }
    function returnToMenu() {
      document.querySelectorAll('.gameMode').forEach(el => el.style.display = 'none');
      document.getElementById('mainMenu').style.display = 'flex';
    }

    // Boyle sliders interaction example (simplified)
    const boyleMass = document.getElementById('boyleMass');
    const boyleTemp = document.getElementById('boyleTemp');
    const boyleMassVal = document.getElementById('boyleMassVal');
    const boyleTempVal = document.getElementById('boyleTempVal');
    boyleMass.addEventListener('input', () => {
      boyleMassVal.textContent = boyleMass.value;
      // Update pressure visualization if needed
    });
    boyleTemp.addEventListener('input', () => {
      boyleTempVal.textContent = boyleTemp.value;
      // Update temperature visualization if needed
    });

    // Avogadro Increase button
    const avogadroIncreaseBtn = document.getElementById('avogadroIncreaseBtn');
    const avogadroBalloon = document.getElementById('avogadroBalloon');
    const avogadroCounter = avogadroBalloon.nextElementSibling.nextElementSibling; // molecule-counter

    let avogadroMolecules = 100;
    avogadroIncreaseBtn.addEventListener('click', () => {
      avogadroMolecules += 10;
      avogadroCounter.textContent = avogadroMolecules;
      avogadroBalloon.style.width = 150 + (avogadroMolecules - 100) * 0.7 + 'px';
      avogadroBalloon.style.height = 200 + (avogadroMolecules - 100) * 0.9 + 'px';
    });


    // -------------------------
    // NEW PARTICLE SYSTEM: Falling Atom Particles
    // -------------------------
    (() => {
      const canvas = document.getElementById('particleCanvas');
      const ctx = canvas.getContext('2d');

      // Resize canvas full window on start & on resize
      function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      resize();
      window.addEventListener('resize', resize);

      // Atom particle parameters and utilities
      class Electron {
        constructor(orbitRadius, angularSpeed, phase, size) {
          this.orbitRadius = orbitRadius; // ellipse radius horizontal
          this.angularSpeed = angularSpeed; // speed of rotation (radians per frame)
          this.phase = phase; // initial angle offset
          this.size = size; // electron radius in px
          this.angle = phase; // current angle
        }
        update() {
          this.angle += this.angularSpeed;
          if (this.angle > Math.PI * 2) this.angle -= Math.PI * 2;
        }
        getPosition(cx, cy) {
          // elliptical orbit: x = cx + rx*cos(angle), y = cy + ry*sin(angle)
          // let's vary ry = orbitRadius * 0.6 for elliptical shape
          return {
            x: cx + this.orbitRadius * Math.cos(this.angle),
            y: cy + this.orbitRadius * 0.6 * Math.sin(this.angle)
          };
        }
      }

      class AtomParticle {
        constructor() {
          this.reset();
        }
        reset() {
          this.x = Math.random() * canvas.width;
          this.y = -20 - Math.random() * 60; // spawn slightly above the viewport
          this.fallSpeed = 0.5 + Math.random() * 0.6; // slower fall 0.5-1.1 px/frame
          this.size = 18 + Math.random() * 10; // atom nucleus radius (18-28 px)
          this.color = 'rgba(255, 90, 95, 0.9)'; // classic pink/red with slight alpha

          // Electrons count: 3-6 electrons
          this.electronCount = 3 + Math.floor(Math.random() * 4);

          // Create electrons with random orbit radius, speed, phase, and size
          this.electrons = [];
          for (let i = 0; i < this.electronCount; i++) {
            let orbitR = this.size + 6 + Math.random() * 12; // orbit radius outside nucleus
            let speed = 0.01 + Math.random() * 0.02; // slow angular speed
            let phase = (Math.PI * 2 / this.electronCount) * i + (Math.random() * 0.3);
            let eSize = 2 + Math.random() * 1.5;
            this.electrons.push(new Electron(orbitR, speed, phase, eSize));
          }
        }
        update() {
          this.y += this.fallSpeed;
          if (this.y - this.size > canvas.height) {
            this.reset();
            this.y = -20;
          }
          this.electrons.forEach(e => e.update());
        }
        draw(ctx) {
          // Draw nucleus (circle)
          ctx.save();
          ctx.translate(this.x, this.y);

          // Nucleus glow effect with radial gradient
          const grad = ctx.createRadialGradient(0, 0, this.size * 0.3, 0, 0, this.size);
          grad.addColorStop(0, 'rgba(255, 90, 95, 1)');
          grad.addColorStop(1, 'rgba(255, 90, 95, 0)');
          ctx.fillStyle = grad;
          ctx.beginPath();
          ctx.arc(0, 0, this.size, 0, Math.PI * 2);
          ctx.fill();

          // Solid nucleus core
          ctx.fillStyle = this.color;
          ctx.beginPath();
          ctx.arc(0, 0, this.size * 0.6, 0, Math.PI * 2);
          ctx.fill();

          // Draw electrons as small circles on elliptical orbits
          ctx.strokeStyle = 'rgba(255, 90, 95, 0.7)';
          ctx.lineWidth = 1.5;
          this.electrons.forEach(e => {
            // Draw orbit ellipse
            ctx.beginPath();
            ctx.ellipse(0, 0, e.orbitRadius, e.orbitRadius * 0.6, 0, 0, Math.PI * 2);
            ctx.stroke();
          });

          // Draw electron circles
          ctx.fillStyle = 'rgba(255, 160, 160, 0.9)';
          this.electrons.forEach(e => {
            const pos = e.getPosition(0, 0);
            ctx.beginPath();
            ctx.arc(pos.x, pos.y, e.size, 0, Math.PI * 2);
            ctx.fill();
            // electron glow
            const glow = ctx.createRadialGradient(pos.x, pos.y, e.size * 0.3, pos.x, pos.y, e.size * 1.8);
            glow.addColorStop(0, 'rgba(255,160,160,0.7)');
            glow.addColorStop(1, 'rgba(255,160,160,0)');
            ctx.fillStyle = glow;
            ctx.beginPath();
            ctx.arc(pos.x, pos.y, e.size * 1.8, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = 'rgba(255, 160, 160, 0.9)'; // restore fill style
          });

          ctx.restore();
        }
      }

      // Create multiple particles for denser effect
      const particles = [];
      const PARTICLE_COUNT = 40; // More particles for faster spawn

      for (let i = 0; i < PARTICLE_COUNT; i++) {
        let p = new AtomParticle();
        p.y = Math.random() * canvas.height; // Start random vertical position for staggered fall
        particles.push(p);
      }

      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach(p => {
          p.update();
          p.draw(ctx);
        });
        requestAnimationFrame(animate);
      }
      animate();
    })();
  </script>
</body>
</html>
(() => {
  const canvas = document.getElementById('particleCanvas');
  const ctx = canvas.getContext('2d');

  function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  resize();
  window.addEventListener('resize', resize);

  class Electron {
    constructor(orbitRadius, angularSpeed, phase, size) {
      this.orbitRadius = orbitRadius;
      this.angularSpeed = angularSpeed;
      this.phase = phase;
      this.size = size;
      this.angle = phase;
    }
    update() {
      this.angle += this.angularSpeed;
      if (this.angle > Math.PI * 2) this.angle -= Math.PI * 2;
    }
    getPosition(cx, cy) {
      return {
        x: cx + this.orbitRadius * Math.cos(this.angle),
        y: cy + this.orbitRadius * 0.6 * Math.sin(this.angle)
      };
    }
  }

  class AtomParticle {
    constructor() {
      this.reset();
    }
    reset() {
      this.x = Math.random() * canvas.width;
      this.y = -20 - Math.random() * 150; // spawn higher for natural spread
      this.fallSpeed = 0.15 + Math.random() * 0.15; // slower fall 0.15-0.3 px/frame
      this.size = 18 + Math.random() * 10;
      this.color = 'rgba(255, 90, 95, 0.9)';
      this.electronCount = 3 + Math.floor(Math.random() * 4);
      this.electrons = [];
      for (let i = 0; i < this.electronCount; i++) {
        let orbitR = this.size + 6 + Math.random() * 12;
        let speed = 0.01 + Math.random() * 0.02;
        let phase = (Math.PI * 2 / this.electronCount) * i + (Math.random() * 0.3);
        let eSize = 2 + Math.random() * 1.5;
        this.electrons.push(new Electron(orbitR, speed, phase, eSize));
      }
    }
    update() {
      this.y += this.fallSpeed;
      if (this.y - this.size > canvas.height) {
        this.reset();
        this.y = -20;
      }
      this.electrons.forEach(e => e.update());
    }
    draw(ctx) {
      ctx.save();
      ctx.translate(this.x, this.y);
      const grad = ctx.createRadialGradient(0, 0, this.size * 0.3, 0, 0, this.size);
      grad.addColorStop(0, 'rgba(255, 90, 95, 1)');
      grad.addColorStop(1, 'rgba(255, 90, 95, 0)');
      ctx.fillStyle = grad;
      ctx.beginPath();
      ctx.arc(0, 0, this.size, 0, Math.PI * 2);
      ctx.fill();
      ctx.fillStyle = this.color;
      ctx.beginPath();
      ctx.arc(0, 0, this.size * 0.6, 0, Math.PI * 2);
      ctx.fill();
      ctx.strokeStyle = 'rgba(255, 90, 95, 0.7)';
      ctx.lineWidth = 1.5;
      this.electrons.forEach(e => {
        ctx.beginPath();
        ctx.ellipse(0, 0, e.orbitRadius, e.orbitRadius * 0.6, 0, 0, Math.PI * 2);
        ctx.stroke();
      });
      ctx.fillStyle = 'rgba(255, 160, 160, 0.9)';
      this.electrons.forEach(e => {
        const pos = e.getPosition(0, 0);
        ctx.beginPath();
        ctx.arc(pos.x, pos.y, e.size, 0, Math.PI * 2);
        ctx.fill();
        const glow = ctx.createRadialGradient(pos.x, pos.y, e.size * 0.3, pos.x, pos.y, e.size * 1.8);
        glow.addColorStop(0, 'rgba(255,160,160,0.7)');
        glow.addColorStop(1, 'rgba(255,160,160,0)');
        ctx.fillStyle = glow;
        ctx.beginPath();
        ctx.arc(pos.x, pos.y, e.size * 1.8, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillStyle = 'rgba(255, 160, 160, 0.9)';
      });
      ctx.restore();
    }
  }

  const particles = [];
  const PARTICLE_COUNT = 15; // fewer for lighter effect

  for (let i = 0; i < PARTICLE_COUNT; i++) {
    let p = new AtomParticle();
    p.y = Math.random() * canvas.height;
    particles.push(p);
  }

  function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    particles.forEach(p => {
      p.update();
      p.draw(ctx);
    });
    requestAnimationFrame(animate);
  }
  animate();
})();
