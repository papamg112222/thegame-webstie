<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gas Laws Game</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600&display=swap');
    html, body { margin:0; padding:0; height:100%; font-family:'Montserrat',sans-serif; background:#1a0a3a; overflow:hidden; color:white; }
    #particleCanvas { position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:0;pointer-events:none; }

    #mainMenu { position:relative; z-index:1; height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; }
    #mainMenu h1 { font-weight:600; font-size:4rem; margin-bottom:0.3em; letter-spacing:5px; color:#ff5a5f; }
    #mainMenu h3 { font-weight:300; font-size:1.2rem; margin-bottom:2em; color:#ff7a7f; }
    #mainMenu button {
      background:#ff5a5f; border:none; border-radius:50px; color:white;
      font-size:1.5rem; padding:16px 80px; margin:12px 0;
      cursor:pointer; box-shadow:0 4px 8px rgba(255,90,95,0.4);
      transition:background-color .3s;
    }
    #mainMenu button:hover { background:#ff7a7f; }

    .gameMode {
      display:none; position:relative; z-index:2;
      height:100vh; padding:20px; box-sizing:border-box;
      background:#111; color:white; display:flex;
      flex-direction:column; align-items:center; justify-content:center;
    }

    .container {
      background:#222; border-radius:12px; padding:20px;
      width:350px; position:relative; display:flex;
      flex-direction:column; align-items:center;
    }

    .return-btn {
      margin-top:20px; padding:10px 20px;
      font-size:16px; background:#ff5a5f;
      color:white; border:none; border-radius:5px;
      cursor:pointer; width:140px;
    }

    .slider-container { margin:15px 0; width:300px; color:#ff5a5f; }
    .slider-container label { display:block; margin-bottom:6px; font-weight:600; }
    input[type=range] { width:100%; }

    .balloon-container {
      position:relative; width:250px; height:250px;
      display:flex; justify-content:center; align-items:center;
    }
    .balloon {
      border-radius:50%/60%;
      transition:width .3s, height .3s;
      position:relative;
    }
    .molecule-teller-bg, .molecule-counter {
      position:absolute; top:10px; left:50%;
      transform:translateX(-50%);
      font-weight:900; z-index:1; user-select:none;
    }
    .molecule-teller-bg { font-size:180px; opacity:0.1; letter-spacing:20px; }
    .molecule-counter { font-size:48px; top:60px; }

    /* 1) Charles balloon nearly opaque */
    #charlesBalloon { background:rgba(255,90,95,0.99) !important; }

    /* 2) Avogadro spacing */
    #avogadro .container { margin-bottom:1cm; }
    #avogadroIncreaseBtn { margin-bottom:0.5cm; }
    #avogadro .return-btn { margin-top:0.5cm; }
  </style>
</head>
<body>
  <canvas id="particleCanvas"></canvas>

  <div id="mainMenu">
    <h1>GAS LAWS GAME</h1>
    <h3>Choose your mode</h3>
    <button onclick="showMode('boyle')">Boyle's Law</button>
    <button onclick="showMode('charles')">Charles' Law</button>
    <button onclick="showMode('gayLussac')">Gay‚ÄëLussac's Law</button>
    <button onclick="showMode('avogadro')">Avogadro's Law</button>
    <button id="memberBtn">Member</button>
  </div>

  <!-- Boyle -->
  <div id="boyle" class="gameMode">
    <div class="container" style="height:500px;">
      <h2>Boyle's Law</h2>
      <div class="slider-container">
        <label>Mass: <span id="boyleMassVal">10</span></label>
        <input type="range" id="boyleMass" min="1" max="20" value="10">
      </div>
      <canvas id="boyleCanvas" width="300" height="300" style="background:#222; border-radius:12px;"></canvas>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <!-- Charles -->
  <div id="charles" class="gameMode">
    <div class="container" style="height:450px;">
      <h2>Charles' Law</h2>
      <div class="balloon-container">
        <div id="charlesBalloon" class="balloon" style="width:80px;height:120px;background:rgba(255,90,95,0.99);"></div>
        <div id="charlesMoleculeBg" class="molecule-teller-bg">0</div>
      </div>
      <div class="slider-container">
        <label>Temperature: <span id="charlesTempVal">0</span>¬∞C</label>
        <input type="range" id="charlesTemp" min="0" max="100" value="0">
      </div>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <!-- Gay-Lussac -->
  <div id="gayLussac" class="gameMode">
    <div class="container" style="height:450px;">
      <h2>Gay‚ÄêLussac's Law</h2>
      <div class="balloon-container">
        <div id="gayLussacBalloon" class="balloon" style="width:150px;height:225px;background:rgba(255,90,95,0.25);"></div>
      </div>
      <div class="slider-container">
        <label>Pressure: <span id="gayLussacPressureVal">1</span></label>
        <input type="range" id="gayLussacPressure" min="1" max="10" value="1">
      </div>
      <div class="slider-container">
        <label>Temperature: <span id="gayLussacTempVal">20</span>¬∞C</label>
        <input type="range" id="gayLussacTemp" min="0" max="100" value="20">
      </div>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <!-- Avogadro -->
  <div id="avogadro" class="gameMode">
    <button id="avogadroIncreaseBtn">üî∫ Add Mass</button>
    <div class="container" style="height:300px;">
      <h2>Avogadro's Law</h2>
      <div class="balloon-container">
        <div id="avogadroBalloon" class="balloon" style="width:80px;height:120px;background:rgba(255,90,95,0.25);"></div>
        <div id="avogadroMoleculeBg" class="molecule-teller-bg">0</div>
        <div id="avogadroMoleculeCounter" class="molecule-counter">0</div>
      </div>
    </div>
    <button class="return-btn" onclick="returnToMenu()">Return to Menu</button>
  </div>

  <!-- Member -->
  <div id="memberGame" class="gameMode">
    <div class="box" style="display:flex; justify-content:space-between; width:300px;height:300px; border:2px solid #ff5a5f;">
      <div class="line"></div><div class="line"></div><div class="line"></div>
      <div class="line"></div><div class="line"></div><div class="line"></div>
    </div>
    <button class="return-btn" onclick="returnFromMemberGame()">Return to Menu</button>
  </div>

  <audio id="popSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>

  <script>
    const modes = {
      boyle: document.getElementById('boyle'),
      charles: document.getElementById('charles'),
      gayLussac: document.getElementById('gayLussac'),
      avogadro: document.getElementById('avogadro'),
      memberGame: document.getElementById('memberGame'),
    };
    const mainMenu = document.getElementById('mainMenu');
    document.getElementById('memberBtn').onclick = () => showMode('memberGame');
    function showMode(m) {
      mainMenu.style.display = 'none';
      Object.values(modes).forEach(el => el.style.display = 'none');
      modes[m].style.display = 'flex';
    }
    function returnToMenu() {
      Object.values(modes).forEach(el => el.style.display = 'none');
      mainMenu.style.display = 'flex';
    }
    function returnFromMemberGame() { returnToMenu(); }

    // Particle background (falling atoms)
    const canvas = document.getElementById('particleCanvas');
    const ctx = canvas.getContext('2d');
    let parts = [];
    window.onresize = () => { canvas.width = innerWidth; canvas.height = innerHeight; initParticles(); };
    function initParticles() {
      parts = [];
      for (let i = 0; i < 80; i++) {
        parts.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          r: Math.random() * 5 + 2,
          vy: Math.random() * 1 + 0.5,
          color: '#ff5a5f',
        });
      }
    }
    function drawParticles() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      parts.forEach(p => {
        p.y += p.vy;
        if (p.y - p.r > canvas.height) p.y = -p.r;
        ctx.beginPath();
        ctx.fillStyle = p.color;
        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        ctx.fill();
      });
      requestAnimationFrame(drawParticles);
    }
    initParticles();
    drawParticles();

    // Boyle mode
    const bMass = document.getElementById('boyleMass');
    const bMassVal = document.getElementById('boyleMassVal');
    const bCanvas = document.getElementById('boyleCanvas');
    const bctx = bCanvas.getContext('2d');
    let balls = [], bAnim;
    function setupBoyle() {
      bMassVal.textContent = bMass.value;
      balls = [];
      const n = +bMass.value;
      const speed = 5 / n;
      for (let i = 0; i < n; i++) {
        balls.push({
          x: Math.random()*280+10, y: Math.random()*280+10,
          vx: (Math.random()-0.5)*speed, vy:(Math.random()-0.5)*speed,
          r:10
        });
      }
      animateBoyle();
    }
    function animateBoyle(){
      bctx.clearRect(0,0,300,300);
      bctx.strokeStyle = '#ff5a5f'; bctx.strokeRect(5,5,290,290);
      balls.forEach(b=>{
        b.x += b.vx; b.y += b.vy;
        if(b.x<5+b.r||b.x>295-b.r) b.vx*=-1;
        if(b.y<5+b.r||b.y>295-b.r) b.vy*=-1;
        bctx.beginPath();bctx.fillStyle='#ff5a5f';bctx.arc(b.x,b.y,b.r,0,2*Math.PI);bctx.fill();
      });
      bAnim = requestAnimationFrame(animateBoyle);
    }
    bMass.oninput = () => { cancelAnimationFrame(bAnim); setupBoyle(); }
    document.querySelector('#boyleTemp')?.oninput = () => {}; // placeholder

    // Charles mode
    const cTemp = document.getElementById('charlesTemp');
    const cTempVal = document.getElementById('charlesTempVal');
    const cBalloon = document.getElementById('charlesBalloon');
    const cBg = document.getElementById('charlesMoleculeBg');
    function updateCharles(){
      const t = +cTemp.value;
      cTempVal.textContent = t;
      const s = 0.8 + t/100;
      cBalloon.style.width = 80*s+'px';
      cBalloon.style.height=120*s+'px';
      cBg.textContent = t;
    }
    cTemp.oninput = updateCharles;
    updateCharles();

    // Gay-Lussac
    const pS = document.getElementById('gayLussacPressure'),
          tS = document.getElementById('gayLussacTemp'),
          pVal = document.getElementById('gayLussacPressureVal'),
          tVal = document.getElementById('gayLussacTempVal'),
          gBalloon = document.getElementById('gayLussacBalloon');
    function updateGay(){
      pVal.textContent = pS.value;
      tVal.textContent = tS.value;
      const sz = 100 + (+pS.value* +tS.value)/2;
      gBalloon.style.width = sz+'px';
      gBalloon.style.height = sz+'px';
    }
    pS.oninput = tS.oninput = updateGay;
    updateGay();

    // Avogadro
    const aBtn = document.getElementById('avogadroIncreaseBtn');
    const aBalloon = document.getElementById('avogadroBalloon');
    const aBg = document.getElementById('avogadroMoleculeBg');
    const aCnt = document.getElementById('avogadroMoleculeCounter');
    const popSound = document.getElementById('popSound');
    let ac = 0;
    aBtn.onmousedown = () => {
      const iv = setInterval(() => {
        ac++;
        if (ac >= 100) {
          aBalloon.style.transition = 'transform .5s';
          aBalloon.style.transform = 'scale(0)';
          popSound.play();
          clearInterval(iv);
          setTimeout(()=>{
            ac = 0;
            aBalloon.style.transform = '';
            aBalloon.style.transition = '';
            resizeAvogadro();
          }, 600);
        } else resizeAvogadro();
      }, 100);
      document.onmouseup = () => clearInterval(iv);
    };
    function resizeAvogadro(){
      aCnt.textContent = ac;
      aBg.textContent = ac;
      const s = 1 + ac/100;
      aBalloon.style.width = 80*s+'px';
      aBalloon.style.height = 120*s+'px';
    }
  </script>
</body>
</html>
