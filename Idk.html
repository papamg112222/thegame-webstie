<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3D Fighting Game Prototype</title>
<style>
  body { margin: 0; overflow: hidden; }
  canvas { display: block; }
</style>
</head>
<body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r152/three.min.js"></script>
<script>

// Scene, camera, renderer
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x222222);

const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0, 10, 20);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Light
const light = new THREE.DirectionalLight(0xffffff, 1);
light.position.set(10, 20, 10);
scene.add(light);

// Ground
const groundGeo = new THREE.PlaneGeometry(50, 50);
const groundMat = new THREE.MeshStandardMaterial({color: 0x444444});
const ground = new THREE.Mesh(groundGeo, groundMat);
ground.rotation.x = -Math.PI/2;
scene.add(ground);

// Players
class Player {
    constructor(x, color) {
        const geometry = new THREE.BoxGeometry(1, 3, 1);
        const material = new THREE.MeshStandardMaterial({color});
        this.mesh = new THREE.Mesh(geometry, material);
        this.mesh.position.set(x, 1.5, 0);
        scene.add(this.mesh);
        this.speed = 0.2;
        this.isAttacking = false;
        this.health = 100;
    }

    move(dx, dz) {
        this.mesh.position.x += dx * this.speed;
        this.mesh.position.z += dz * this.speed;
    }

    attack() {
        this.isAttacking = true;
        setTimeout(()=>this.isAttacking=false, 300); // short attack animation
    }
}

const player1 = new Player(-5, 0xff0000);
const player2 = new Player(5, 0x0000ff);

// Key controls
const keysPressed = {};
window.addEventListener('keydown', e => keysPressed[e.key] = true);
window.addEventListener('keyup', e => keysPressed[e.key] = false);

// Simple collision / attack
function checkAttack(attacker, defender) {
    if(attacker.isAttacking) {
        const dist = attacker.mesh.position.distanceTo(defender.mesh.position);
        if(dist < 2) {
            defender.health -= 1; // small damage
        }
    }
}

// Health display
const player1HealthDiv = document.createElement('div');
player1HealthDiv.style.position = 'absolute';
player1HealthDiv.style.color = 'red';
player1HealthDiv.style.top = '20px';
player1HealthDiv.style.left = '20px';
player1HealthDiv.style.fontSize = '24px';
document.body.appendChild(player1HealthDiv);

const player2HealthDiv = document.createElement('div');
player2HealthDiv.style.position = 'absolute';
player2HealthDiv.style.color = 'blue';
player2HealthDiv.style.top = '20px';
player2HealthDiv.style.right = '20px';
player2HealthDiv.style.fontSize = '24px';
document.body.appendChild(player2HealthDiv);

// Game loop
function animate() {
    requestAnimationFrame(animate);

    // Player controls
    if(keysPressed['a']) player1.move(-1, 0);
    if(keysPressed['d']) player1.move(1, 0);
    if(keysPressed['w']) player1.move(0, -1);
    if(keysPressed['s']) player1.move(0, 1);
    if(keysPressed[' ']) player1.attack();

    if(keysPressed['ArrowLeft']) player2.move(-1, 0);
    if(keysPressed['ArrowRight']) player2.move(1, 0);
    if(keysPressed['ArrowUp']) player2.move(0, -1);
    if(keysPressed['ArrowDown']) player2.move(0, 1);
    if(keysPressed['Enter']) player2.attack();

    checkAttack(player1, player2);
    checkAttack(player2, player1);

    // Update health display
    player1HealthDiv.innerText = `Player1: ${player1.health}`;
    player2HealthDiv.innerText = `Player2: ${player2.health}`;

    // Camera follow
    camera.position.x = (player1.mesh.position.x + player2.mesh.position.x)/2;
    camera.position.z = (player1.mesh.position.z + player2.mesh.position.z)/2 + 20;
    camera.lookAt((player1.mesh.position.x + player2.mesh.position.x)/2, 0, (player1.mesh.position.z + player2.mesh.position.z)/2);

    renderer.render(scene, camera);
}

animate();

</script>
</body>
</html>
