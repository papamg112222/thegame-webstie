<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roblox Lite Mobile Game</title>
<style>
  body { margin:0; overflow:hidden; font-family:sans-serif;}
  canvas { display:block; }
  #ui {
    position:absolute; bottom:20px; left:50%; transform:translateX(-50%);
    display:flex; gap:15px;
    user-select:none; touch-action:none;
  }
  .btn { padding:18px; background:rgba(0,0,0,0.5); color:white; border-radius:10px; font-size:18px; }
  #score { position:absolute; top:20px; left:20px; color:white; font-size:20px;}
</style>
</head>
<body>
<div id="score">Score: 0</div>
<div id="ui">
  <div class="btn" id="jump">Jump ⬆️</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.154.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.154.0/examples/js/controls/PointerLockControls.js"></script>

<script>
// Scene
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xa0a0a0);

// Camera
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);

// Renderer
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Lighting
const light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(10,20,10);
scene.add(light);
scene.add(new THREE.AmbientLight(0x404040));

// Ground
const groundMat = new THREE.MeshStandardMaterial({color:0x00ff00});
const groundGeo = new THREE.PlaneGeometry(100,100);
const ground = new THREE.Mesh(groundGeo, groundMat);
ground.rotation.x = -Math.PI/2;
scene.add(ground);

// Platforms
const platforms = [];
for(let i=0;i<8;i++){
  const mat = new THREE.MeshStandardMaterial({color:0xff0000});
  const geo = new THREE.BoxGeometry(3,0.5,3);
  const plat = new THREE.Mesh(geo, mat);
  plat.position.set((Math.random()-0.5)*50, Math.random()*5+1, (Math.random()-0.5)*50);
  scene.add(plat);
  platforms.push(plat);
}

// Collectibles
let score = 0;
const collectibles = [];
const scoreDisplay = document.getElementById("score");
for(let i=0;i<8;i++){
  const geo = new THREE.BoxGeometry(0.5,0.5,0.5);
  const mat = new THREE.MeshStandardMaterial({color:0xffff00});
  const cube = new THREE.Mesh(geo, mat);
  cube.position.set((Math.random()-0.5)*50,1,(Math.random()-0.5)*50);
  scene.add(cube);
  collectibles.push(cube);
}

// Roblox-style player (blocky)
const player = new THREE.Group();
const bodyMat = new THREE.MeshStandardMaterial({color:0x0000ff});
const bodyGeo = new THREE.BoxGeometry(1,1.5,0.5);
const body = new THREE.Mesh(bodyGeo, bodyMat);
body.position.y = 0.75;
player.add(body);

const headGeo = new THREE.BoxGeometry(0.7,0.7,0.7);
const head = new THREE.Mesh(headGeo,new THREE.MeshStandardMaterial({color:0xffd1a4}));
head.position.y = 1.75;
player.add(head);

scene.add(player);

// Movement
let velocityY = 0;
const gravity = -0.02;
let onGround = false;
const keys = {left:false,right:false,forward:false,back:false};
const jumpBtn = document.getElementById("jump");
jumpBtn.addEventListener("touchstart",()=>{ if(onGround) velocityY=0.35; onGround=false; });

document.addEventListener("keydown",e=>{
  if(e.key==="ArrowLeft"||e.key==="a") keys.left=true;
  if(e.key==="ArrowRight"||e.key==="d") keys.right=true;
  if(e.key==="ArrowUp"||e.key==="w") keys.forward=true;
  if(e.key==="ArrowDown"||e.key==="s") keys.back=true;
});
document.addEventListener("keyup",e=>{
  if(e.key==="ArrowLeft"||e.key==="a") keys.left=false;
  if(e.key==="ArrowRight"||e.key==="d") keys.right=false;
  if(e.key==="ArrowUp"||e.key==="w") keys.forward=false;
  if(e.key==="ArrowDown"||e.key==="s") keys.back=false;
});

// Camera follow
camera.position.set(0,5,8);
function updateCamera(){
  const targetPos = new THREE.Vector3(player.position.x,player.position.y+2,player.position.z+8);
  camera.position.lerp(targetPos,0.1);
  camera.lookAt(player.position);
}

// Animate
function animate(){
  requestAnimationFrame(animate);

  // Movement
  if(keys.left) player.position.x -= 0.12;
  if(keys.right) player.position.x += 0.12;
  if(keys.forward) player.position.z -= 0.12;
  if(keys.back) player.position.z += 0.12;

  // Gravity
  velocityY += gravity;
  player.position.y += velocityY;

  // Ground collision
  if(player.position.y < 0.75){
    player.position.y = 0.75;
    velocityY=0;
    onGround=true;
  }

  // Platform collision
  platforms.forEach(p=>{
    const dx = Math.abs(player.position.x - p.position.x);
    const dz = Math.abs(player.position.z - p.position.z);
    const dy = player.position.y - 0.75 - (p.position.y + 0.25);
    if(dx<1.5 && dz<1.5 && dy<0.2 && dy>-0.5 && velocityY<=0){
      player.position.y = p.position.y + 0.75 + 0.25;
      velocityY=0;
      onGround=true;
    }
  });

  // Collectibles
  collectibles.forEach((c,i)=>{
    if(c && player.position.distanceTo(c.position)<1){
      scene.remove(c);
      collectibles[i]=null;
      score++;
      scoreDisplay.innerText = "Score: "+score;
    }
  });

  updateCamera();
  renderer.render(scene,camera);
}

animate();

// Resize
window.addEventListener('resize',()=>{
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>
</body>
</html>
